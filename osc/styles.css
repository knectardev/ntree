:root{
  --bg:#0b0e13;
  --panel:#0f1420;
  /* Opaque fill color for in-canvas diagnostic insets (prevents ghosting across frames). */
  --panelBg:#0f1420;
  --fg:#e8eefc;
  --muted:rgba(232,238,252,0.62);
  --grid:rgba(232,238,252,0.08);
  --accent:#ff2fb3;
  --accent2:#7ae3ff;
  --warn:#ffd166;
  --good:#40f99b;
  --bad:#ff5c77;
  --ghost:rgba(232,238,252,0.12);
  --shadow:0 10px 35px rgba(0,0,0,0.55);
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background: radial-gradient(1400px 800px at 18% 12%, rgba(255,47,179,0.12), transparent 55%),
              radial-gradient(900px 600px at 80% 22%, rgba(122,227,255,0.10), transparent 55%),
              var(--bg);
  color:var(--fg);
  overflow-x:hidden;
}
header{
  padding:18px 18px 10px;
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:12px;
}
header h1{
  margin:0;
  font-size:16px;
  font-weight:800;
  letter-spacing:0.2px;
}
header .sub{
  color:var(--muted);
  font-size:12px;
  margin-top:6px;
}
.wrap{
  display:grid;
  /* Make the controls column wide enough for the two 220px dials without creating an inner horizontal scrollbar.
     Do this by using the full viewport width and keeping the left edge flush to the browser edge. */
  grid-template-columns: 520px 1fr;
  gap:12px;
  padding:10px 12px 18px 0;
  max-width:none;
  margin:0;
}
.panel{
  background: linear-gradient(180deg, rgba(255,255,255,0.03), transparent 40%), var(--panel);
  border:1px solid rgba(255,255,255,0.06);
  border-radius:16px;
  box-shadow:var(--shadow);
}
.controls{
  padding:14px;
  display:flex;
  flex-direction:column;
  gap:12px;
  position:sticky;
  top:10px;
  height: calc(100vh - 28px);
  overflow:auto;
}
.row{display:flex; align-items:center; gap:10px; flex-wrap:wrap;}
label{font-size:12px; color:var(--muted);}
select, button, input[type="number"]{
  background:rgba(255,255,255,0.04);
  border:1px solid rgba(255,255,255,0.10);
  color:var(--fg);
  padding:8px 10px;
  border-radius:12px;
  font-size:12px;
  outline:none;
}
/* Native <select> dropdown list fix (Windows/Chrome can show white popup with inherited light text). */
select{ color-scheme:dark; }
select option,
select optgroup{
  background-color: var(--panel);
  color: var(--fg);
}
select option:disabled{ color: rgba(232,238,252,0.45); }
button{cursor:pointer; font-weight:700;}
button:hover{border-color:rgba(255,255,255,0.20);}
.chk{display:flex; align-items:center; gap:8px; font-size:12px; color:var(--muted);}
.chk input{transform:translateY(1px);}
.pill{
  padding:6px 10px;
  border-radius:999px;
  background:rgba(255,255,255,0.04);
  border:1px solid rgba(255,255,255,0.08);
  font-size:12px;
  color:var(--muted);
}

/* --- usability helpers --- */
.insightBox{
  padding:10px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,0.08);
  background:rgba(255,255,255,0.02);
}
.light{
  width:10px;
  height:10px;
  border-radius:999px;
  display:inline-block;
  border:1px solid rgba(255,255,255,0.18);
  box-shadow:0 0 0 3px rgba(0,0,0,0.18) inset;
}
.light.good{ background:rgba(64,249,155,0.95); }
.light.mid{ background:rgba(255,209,102,0.95); }
.light.bad{ background:rgba(255,92,119,0.95); }
.hoverTip{
  position:fixed;
  z-index:2000;
  pointer-events:none;
  padding:8px 10px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.10);
  background:rgba(10,12,18,0.98);
  color:rgba(232,238,252,0.88);
  font-size:11px;
  line-height:1.35;
  box-shadow:0 10px 30px rgba(0,0,0,0.55);
  opacity:0;
  transform:translateY(2px);
  transition:opacity 80ms ease, transform 80ms ease;
  max-width:320px;
  white-space:normal;
}
.hoverTip.on{ opacity:1; transform:translateY(0); }

details.insightBox > summary{
  cursor:pointer;
  user-select:none;
  font-weight:800;
  color:rgba(232,238,252,0.88);
  list-style:none;
}
details.insightBox > summary::-webkit-details-marker{ display:none; }
details.insightBox > summary::before{
  content:"▸";
  display:inline-block;
  margin-right:8px;
  color:rgba(232,238,252,0.55);
  transform:translateY(-1px);
}
details.insightBox[open] > summary::before{ content:"▾"; }

.gateVerdict{
  display:flex;
  align-items:flex-start;
  gap:8px;
  padding:8px 10px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.08);
  background:rgba(255,255,255,0.02);
  margin:8px 0 10px;
}
.gateVerdict .title{ font-weight:800; font-size:12px; }
.gateVerdict .reason{ font-size:11px; color:var(--muted); margin-top:2px; line-height:1.25; }
.gateChecks{
  display:grid;
  grid-template-columns: 1fr;
  gap:6px;
  margin-top:8px;
  font-size:11px;
  color:var(--muted);
}
.gateCheck{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:6px 8px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.06);
  background:rgba(0,0,0,0.10);
}
.gateCheck .k{ color:rgba(232,238,252,0.75); }
.gateCheck.pass{ border-color: rgba(64,249,155,0.22); }
.gateCheck.warn{ border-color: rgba(255,209,102,0.22); }
.gateCheck.fail{ border-color: rgba(255,92,119,0.22); }
.gateCheck.off{ border-color: rgba(232,238,252,0.10); opacity:0.85; }

.grid2{
  display:grid;
  grid-template-columns: 1fr;
  gap:10px;
}

.main{
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:12px;
  min-height: calc(100vh - 40px);
}

.canvasRow{
  display:grid;
  grid-template-columns: 1fr;
  gap:10px;
}

canvas{width:100%; height:100%;}

.chart{
  padding:10px;
  border-radius:14px;
  background:rgba(0,0,0,0.18);
  border:1px solid rgba(255,255,255,0.06);
  position:relative;
  overflow:hidden;
}

.chartTitle{
  position:absolute;
  top:10px; left:12px;
  font-size:12px;
  color:var(--muted);
  display:flex; align-items:center; gap:10px;
  z-index:2;
  user-select:none;
  overflow:visible;
}

.legendDot{width:10px; height:10px; border-radius:999px; display:inline-block;}

.status{
  font-size:12px;
  color:var(--muted);
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}

.tiny{
  font-size:11px;
  color:var(--muted);
  line-height:1.3;
}

.dialRow{display:grid; grid-template-columns: 1fr 1fr; gap:10px;}
.dialCol{
  padding:10px;
  border:1px solid rgba(255,255,255,0.06);
  border-radius:14px;
  background:rgba(255,255,255,0.02);
}
/* Dial visuals: match the knob-like look/feel from oscillator_signal_gate_fixed.html */
.dialWrap{
  width:100%;
  aspect-ratio:1/1;
  border-radius:999px;
  background:radial-gradient(140px 140px at 35% 30%, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0.10) 55%, rgba(0,0,0,0.18) 100%);
  border:1px solid rgba(255,255,255,0.08);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}
.dialCanvas{width:100%; height:100%; display:block;}
.dialValue{font-weight:800; color:var(--fg);}
.dialHelp{font-size:11px; color:var(--muted); margin-top:6px;}
.hiddenInput{display:none;}

.badge{
  padding:4px 8px;
  border-radius:999px;
  font-size:11px;
  border:1px solid rgba(255,255,255,0.10);
  color:var(--muted);
  background:rgba(255,255,255,0.03);
}

.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;}

/* --- tooltips --- */
.tip{
  position:relative;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:16px;
  height:16px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(255,255,255,0.04);
  color:rgba(232,238,252,0.72);
  font-size:11px;
  line-height:1;
  margin-left:6px;
  cursor:help;
  user-select:none;
}
.tip::after{
  content:attr(data-tip);
  position:absolute;
  left:50%;
  top:calc(100% + 10px);
  transform:translateX(-50%);
  min-width:220px;
  max-width:320px;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.10);
  background:rgba(10,12,18,0.98);
  color:rgba(232,238,252,0.88);
  font-size:11px;
  line-height:1.35;
  box-shadow:0 10px 30px rgba(0,0,0,0.55);
  opacity:0;
  pointer-events:none;
  transition:opacity 120ms ease;
  z-index:999;
  white-space:pre-line;
}
.tip:hover::after{ opacity:1; }

@media (max-width: 980px){
  .wrap{grid-template-columns:1fr;}
  .controls{position:relative; height:auto;}
}


